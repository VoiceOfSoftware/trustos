

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>} &mdash; trustos master documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="tutorials.html" />
    <link rel="prev" title="&lt;no title&gt;" href="trust.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          


          
            <a href="index.html" class="icon icon-home"> trustos
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

<br>
<a style="width:100%;" href="index.html">
    <h1 style="color: white; font-size:220%; margin-bottom:2px;">TrustOS</h1>
</a>
<img style="background:none; margin: auto;  width:30%; height:95%;" alt="Telefónica"
    src="_static/images/telefonica_white.png" />

<!-- 
<a href="https://github.com/hyperledger/fabric"></a>
&nbsp;<a href="https://stackoverflow.com/questions/tagged/hyperledger-fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="StackOverflow" src="_static/images/stackoverflow_button.png"/></a>
&nbsp;<a href="https://chat.hyperledger.org"><img style="padding: 0px; margin: auto auto auto auto;" alt="Rocket Chat" src="_static/images/rocketchat_button.png"/></a>
&nbsp;<a href="https://www.youtube.com/playlist?list=PL0MZ85B_96CH7wvtrRzV7SvtRY0sI0DEg"><img style="padding: 0px; margin: auto auto auto auto;" alt="Youtube Channel" src="_static/images/youtube_button.png"/></a> -->


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="track.html">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id16">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id21">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id32">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id37">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id42">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id47">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id52">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id57">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html#id62">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="token.html">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="token.html#id28">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="token.html#id75">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="token.html#id86">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="token.html#id97">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="token.html#id108">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="settle.html">}</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id14">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id17">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id20">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id23">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id26">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id29">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id32">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id35">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id38">}</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">trustos</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>}</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/id.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p># TRUST ID</p>
<p>TrustID is am standalone identity module for TrustOS. We followed a decentralized identity approach for its design, where users (and services) are identified through a DID.</p>
<p>These DIDs follow the W3C standard, and they serve as a unique ID to identify users. DIDs aggregate all the pieces of public information required to authenticate a user (i.e., their public key or X.509 certificate).</p>
<p>![DID](./images/did.png)
![Service DID](./images/service-did.png)</p>
<p>In order to uniquely identify chaincodes and services deployed in TrustOS, we decided to also give them DIDs so that they could be seamlessly discovered and accessed even if they “live” in independent channels not shared by all the organizations of the network.</p>
<p>All the authentication and management of identities in the system is performed on-chain through an “Identity Chaincode.”</p>
<p>If user A wants to start interacting with the network, he requests the generation of a new DID. The related keys to this DID could be an existing X.509 issued by a valid organization, or even an Ethereum-related public key (internally we use all the JWS, JWE, JWK, secp256k1, etc. RFCs to make our Fabric infrastructure compatible with identities of any nature for the sake of interoperability). This DID generation request has to be validated by a valid organization of the network. Once verified, every transaction signed by user A and directed through a Proxy chaincode is authenticated successfully and delegated to the corresponding chaincode.</p>
<p>![TrustID Flow](./images/trustid-flow.png)</p>
<p>The TrustID project is conformed by the aforementioned chaincode and a client SDK to ease the integration and interaction with TrustID-enabled networks.</p>
<p>TrustID is designed to ease the management of identities for the case of TrustOS. Users shouldn’t need to hold a different set of credentials for each network or decentralized application they interact with. The same credentials used to access your owned Bitcoins and manage your tokens in Ethereum should let you update the state of a Fabric asset or launch a secondary market in TrustOS.</p>
<p>## TRUSTID SDK</p>
<p>This SDK exposes all the functionalities required to interact with
TRUSTID-based DLT networks.</p>
<p>### Install
* To install this library you need access to the private repo:
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">npm</span> <span class="pre">install</span> <span class="pre">core-id-sdk</span>
<span class="pre">`</span></code></p>
<p>### Example of use
<a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>js
// Use library
var id = require(‘coren-id-sdk’)
import { Keystore } from ‘./keystore/keystore’;</p>
<p>// Initialize wallet
wal = id.Wallet.Instance;</p>
<p>// Create Keystore
ks = new FileKeystore();
// Set keystore in wallet
wal.setKeystore(ks)
// LoadKeystore from file</p>
<blockquote>
<div><p>wal.loadKeystore(‘file’, ‘./keystore’)</p>
</div></blockquote>
<p>// Set endpoint of driver and store in variable to use it.
const hfdriver = wal.drivers.hf
hfdriver.setEndpoint(“<a class="reference external" href="http://localhost:8080">http://localhost:8080</a>”);</p>
<p>// Use the wallet and the driver
wal.generateDID(“RSA”)
hfdriver.createIdentity(wal.getDID(“default”))</p>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>### Structure
The library has the following modules:</p>
<ul class="simple">
<li><p><cite>wallet.ts</cite>: Core module of the library. It wraps all the state and</p></li>
</ul>
<p>logic for identity management and interaction with TRUSTID networks.
To start using the SDK a new wallet needs to be initialized. A wallet
exposes the following methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>public setKeystore(keystore: Keystore): void</cite>:</p></li>
<li><p><cite>public generateDID(type: string, controller: string = “default”, passphrase: string = “”): DID</cite></p></li>
</ul>
<p>And stores the following information:</p>
</div></blockquote>
<ul>
<li><dl>
<dt><cite>class DID</cite>: Has the following structure.</dt><dd><ul class="simple">
<li><p><cite>public id: string</cite>: Id string that identifies the DID.</p></li>
<li><p><cite>public pubkey: string</cite>: PublicKey of the DID.</p></li>
<li><p><cite>public type: string</cite>: Key type (RSA / EC / OKP).</p></li>
<li><p><cite>public controller: string</cite>: Verifier of the identity</p></li>
<li><p><cite>public access: number</cite>: Access level</p></li>
<li><p><cite>private privkey: string</cite>: Private Key of the DID.</p></li>
</ul>
<p>And exposes the following functions:
* <cite>public unlockAccount(passphrase: string = “”): void</cite>: Unlocks private key in order to use the DID.
* <cite>public lockAccount(): any</cite>: Locks the private key for a DID.
* <cite>public sign(payload: object, passphrase: string = “”): string</cite>: Sign a payload with a specific DID.
* <cite>public verify(signature: string, id: string = “default”): any</cite>: Verifies a signature from a DID.</p>
</dd>
</dl>
</li>
<li><p><cite>driver.ts</cite>: Interface that enables the implementation of connection drivers with different TRUSTID networks. The only driver implemented currently is</p></li>
</ul>
<p>the <cite>hfdriver.ts</cite> enabling the interaction with Hyperledger Fabric TrustID
networks.</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>setEndpoint(endpoint: string): void</cite>: Sets the network endpoint to interact with the TRUSTID network.</p></li>
<li><p><cite>createIdentity(did: DID): Promise&lt;object&gt;</cite>: Create an identity in TrustID. It generates a new DID in the wallet and register it in the network.</p></li>
<li><p><cite>verifyIdentity(adminDID: DID, id:string): Promise&lt;object&gt;</cite>: Verifies an identity as an admin.</p></li>
<li><p><cite>getIdentity(did: DID, id: string): * Promise&lt;object&gt;</cite>: Gets a registered identity from TrustID.</p></li>
<li><p><cite>revokeIdentity(adminDID: DID, id: string): Promise&lt;object&gt;</cite>: Revokes a registered identity. Only supported by the owner or controller of the DID.</p></li>
<li><p><cite>createService(did: DID, serviceDID: string, name: string, isPublic: boolean): Promise&lt;object&gt;</cite>: Creates a new service in the TrustID network.</p></li>
<li><p><cite>updateService(did: DID, serviceDID: string, access: Access, isPublic: boolean): Promise&lt;object&gt;</cite>: Updates the information from a service.</p></li>
<li><p><cite>getService(did: DID, serviceDID: string): Promise&lt;object&gt;</cite>: Gets information from a registered service.</p></li>
<li><p><cite>invoke (did: DID, serviceDID: string, args: string[], channel: string): Promise&lt;object&gt;</cite>: Invokes a function of a registered service in the TrustID network.</p></li>
<li><p><cite>query(did: DID, serviceDID: string, args: string[], channel: string): Promise&lt;object&gt;</cite>: Queries a function of a registered service in the TrustID network</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt><cite>keystore.ts</cite>: Interface that enables the implementation of keystore storages.</dt><dd><p>There are currently two implementations of keystore supported: <cite>FileKeystore.ts</cite> (to store DIDs in file keystore)and <cite>MongoKeystore.ts</cite> (to store DIDs in MongoDB).</p>
<ul>
<li><p><cite>abstract getDID(id: string): DID</cite>: Get specific DID from keystore.</p></li>
<li><p><cite>abstract storeDID(did: DID): boolean</cite>: Store DID in keystore.</p></li>
<li><p><cite>public storeInMemory(did: DID): boolean</cite>: Store DID inMemory for easy and performant use.</p></li>
<li><p><cite>public listDID(): string[]</cite>: List DIDs in memory.</p></li>
<li><p><cite>public setDefault(did: DID): boolean</cite>: Set DID as default identity for the keystore wallet.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>If you want additional information of TrustID, its SDK and its functionality
check the following [repo](<a class="reference external" href="https://github.com/telefonica-tid/coren-id-sdk">https://github.com/telefonica-tid/coren-id-sdk</a>).</p>
<p>## ID API</p>
<p>TrustID API implementation. It wraps the functionality of the TRUSTID SDK
in order to offer basic identity management services to users comfortable
delegating the responsability of their keys to a custodian. ID API acts
as the third-party custodian of the users keys.</p>
<p>### API SPECIFICATIONS</p>
<p>The implementation considers that the API is the third-party custodial of
TrustID keys. Currently the keystore is implemented with a FileKeystore,
MongoKeystore comming soon. Private keys from users are stored ciphered
with a passphrase. In order to call every function and unlock the account
the passphrase needs to be provided. The API has the following routes.</p>
<ul class="simple">
<li><p><cite>/id/login</cite>: It return a JWT to interact with services authenticated</p></li>
</ul>
<p>using JWT using TrustID as identity backend. This functionality is offered
for every user in the system (even those for which we are not the
custodials of the keys). Some services may be still authenticated with JWT,
and we want to support this authentication even of TRUST ID users.
<a href="#id9"><span class="problematic" id="id10">``</span></a>`
{</p>
<blockquote>
<div><p>“id”: “did:vtn:trustid:ae0213fncasdf234”,
“password”: “pass”,
“payload”: {</p>
<blockquote>
<div><p>“arg1”: “NonCustodianu”,
“arg2”: “seSDKtoGeneratePayload”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<div class="section" id="id11">
<h1>}<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/id/refresh</cite>: It refreshes a JWT login.</p></li>
<li><p><cite>/id/sign</cite>: Requests a signature using a key in custody. Useful when a user has to</p></li>
</ul>
<p>share signed payloads off-chain.
<a href="#id12"><span class="problematic" id="id13">``</span></a>`
{</p>
<blockquote>
<div><p>“password”: “passphrase”,
“payload”: {</p>
<blockquote>
<div><p>“arg1”: “test”,
“arg2”: “payload”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
</div>
<div class="section" id="id14">
<h1>}<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/id/revoke</cite>: Sends a request to revoke a specific identity. You need to be</p></li>
</ul>
<p>the owner of the identity or its controller to perform this task.
<a href="#id15"><span class="problematic" id="id16">``</span></a>`
{</p>
<blockquote>
<div><p>“id”: “did:vtn:test”,
“password”: “passphrase”</p>
</div></blockquote>
</div>
<div class="section" id="id17">
<h1>}<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/id/create</cite>: Create a new identity with the key determined in type and a</p></li>
</ul>
<p>passphrase to lock the private key.
<a href="#id18"><span class="problematic" id="id19">``</span></a>`
{</p>
<blockquote>
<div><p>“password”: “passphrase”,
“type”: “RSA”</p>
</div></blockquote>
</div>
<div class="section" id="id20">
<h1>}<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/id/verify</cite>: Verification of a registered identity by a controller in the system.</p></li>
</ul>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a>`
{</p>
<blockquote>
<div><p>“id”: “did:vtn:test”,
“password”: “passphrase”</p>
</div></blockquote>
</div>
<div class="section" id="id23">
<h1>}<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/id/get</cite>: Gets the information from a registered identity.</p></li>
</ul>
<p><a href="#id24"><span class="problematic" id="id25">``</span></a>`
{</p>
<blockquote>
<div><p>“id”: “did:vtn:service:012343”,
“password”: “passphrase”</p>
</div></blockquote>
</div>
<div class="section" id="id26">
<h1>}<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/service/create</cite>: Create a new service in the TRUSTID network.</p></li>
</ul>
<p><a href="#id27"><span class="problematic" id="id28">``</span></a>`
{</p>
<blockquote>
<div><p>“serviceID”: “coren-trustcc”,
“password”: “passphrase”,
“name”: “chaincode-name”,
“isPublic”: true</p>
</div></blockquote>
</div>
<div class="section" id="id29">
<h1>}<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/service/update</cite>: Updates the information of a service.</p></li>
</ul>
<p><a href="#id30"><span class="problematic" id="id31">``</span></a>`
{</p>
<blockquote>
<div><p>“serviceID”: “coren-trustcc”,
“password”: “passphrase”,
“access”: 0,
“isPublic”: true</p>
</div></blockquote>
</div>
<div class="section" id="id32">
<h1>}<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/service/get</cite>: Gets the registered information for a service.</p></li>
</ul>
<p><a href="#id33"><span class="problematic" id="id34">``</span></a>`
{</p>
<blockquote>
<div><p>“serivceID”: “did:vtn:service:012343”,
“password”: “passphrase”</p>
</div></blockquote>
</div>
<div class="section" id="id35">
<h1>}<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><cite>/service/invoke</cite>: Invoke a function from a distributed service using TrustID.</p></li>
</ul>
<p><a href="#id36"><span class="problematic" id="id37">``</span></a>`
{</p>
<blockquote>
<div><p>“serviceID”: “did:vtn:trustos:123drfw”,
“password”: “passphrase”,
“args”: [</p>
<blockquote>
<div><p>“a”,
“b”,
“200”</p>
</div></blockquote>
<p>],
“channel”: “channel1”,
“function”: “create”</p>
</div></blockquote>
</div>
<div class="section" id="id38">
<h1>}<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h1>
<p>If you want additional information about this API implementation and its functionality
check the following [repo](<a class="reference external" href="https://github.com/telefonica-tid/coren-id-api">https://github.com/telefonica-tid/coren-id-api</a>).</p>
<p>## ROADMAP
Work in progress…</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorials.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="trust.html" class="btn btn-neutral" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <!-- <div role="contentinfo">
    <p>
        &copy; Copyright Telefónica 2020.

    </p>
  </div> -->
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>